function refresh(){var n=$("#navPathfld").val();n==="ThisPc"?getDrives(function(n){InitialContentData(n)}):(getDirectories(n,function(n){BindContentData(n)}),getFiles(n,function(n){BindContentDataFiles(n)}))}function getDrives(n){$("#navPathfld").prop("value","ThisPc");$.ajax({url:"/Home/GetInitialDriveAndDirectories",method:"GET",contentType:JSON,success:function(t){n(t)}})}function getDirectories(n,t){$.ajax({url:"/Home/GetInternalDriveAndDirectories",method:"GET","async":!1,contentType:JSON,data:{path:n},success:function(n){console.log(n);t(n.data)}})}function SearchDirectoriesByName(n,t,i){data={path:n,searchPattern:t};$.ajax({url:"/Home/GetTnternalDirectoriesByName",method:"GET",contentType:JSON,data:data,success:function(n){i(n)}})}function getFiles(n,t){$.ajax({url:"/Home/GetInternalFiles",method:"GET",contentType:JSON,data:{path:n},success:function(n){t(n.data)}})}function SearchFilesByName(n,t,i){data={path:n,searchPattern:t};$.ajax({url:"/Home/GetInternalFilesByName",method:"GET",contentType:JSON,data:data,success:function(n){i(n)}})}function BindInitialTreeView(n){$.each(n,function(n,t){var i="";i='<li id="mainfiles" data-path="'+n+'" data-icon="<span class=\'mif-star-full\'><\/span>" data-caption="'+n+'" class="tree-node expanded">';i+='<span class="icon"><span class="mif-drive2"><\/span><\/span>';i+='<span class="caption">'+n+"<\/span>";i+=Bind_Li_Data(t);i+='<span class="node-toggle"><\/span><\/li>';$("#treemain").append(i)})}function Bind_Li_Data(n){var t='<ul id="myList">';return $.each(n,function(n,i){var r=i.item2.lastIndexOf("\\"),u=i.item2.substring(r+1,r+15);t+='<li id="files" data-path="'+i.item2+'" data-icon="<span class=\'mif-library\'><\/span>" data-caption="'+u+'"';i.item1>0&&(t+='class="tree-node"');t+='><span class="icon"><span class="mif-folder"><\/span><\/span>';t+='<span class="caption">'+u+"<\/span>";i.item1>0&&(t+='<span class="node-toggle"><\/span>');t+="<\/li>"}),t+="<\/ul>"}function BindInternalTreeView(n,t){var i="",r,u;$.each(n,function(n,t){i+=Bind_Li_Data(t)});r=$(t).find("ul");r.remove();u=$(t).find("span:last");u.before(i)}function BindContentData(n){var t="";$.each(n,function(n,i){t+='<li><ul class="listview view-icons-medium">';$.each(i,function(n,i){var r=i.item2.lastIndexOf("\\"),u=i.item2.substring(r+1,r+15);t+='<li id="Contentfiles" data-path="'+i.item2+'" data-caption="'+u+'" class="node"><label class="checkbox transition-on"><input type="checkbox" data-role="checkbox" data-style="1" data-role-checkbox="true" class=""><span class="check"><\/span><span class="caption"><\/span><\/label><span class="icon">';t+='<div class="folder"><\/div>';t+='<\/span><div class="data"><div class="caption">'+u+"<\/div><\/div><\/li>"})});t+="<\/ul>";t+="<\/li>";$("#listview").empty();$("#listview").append(t)}function InitialContentData(n){var t="";t+='<li data-caption="Devices and disks" class="node-group expanded" ><div class="data"><div class="caption">Devices and disks<\/div><\/div>';t+='<ul class="listview view-icons-medium">';$.each(n,function(n){t+='<li id="Contentfiles" data-path="'+n+'" data-caption="'+n+'" class="node"><label class="checkbox transition-on"><input type="checkbox" data-role="checkbox" data-style="1" data-role-checkbox="true" class=""><span class="check"><\/span><span class="caption"><\/span><\/label><span class="icon">';t+='<div class="drive"><\/div>';t+='<\/span><div class="data"><div class="caption">'+n+"<\/div><\/div><\/li>"});t+="<\/ul>";t+="<\/li>";$("#listview").empty();$("#listview").append(t)}function BindContentDataFiles(n){var t="";$.each(n,function(n,i){t+='<li><ul class="listview view-icons-medium">';$.each(i,function(n,i){var r=i.item2.lastIndexOf("\\"),u=i.item2.substring(r+1,r+15),f;t+='<li id="Contentfiles" data-path="'+i.item2+'"';t+='data - caption="'+u+'" class="node" ><label class="checkbox transition-on"><input type="checkbox" data-role="checkbox" data-style="1" data-role-checkbox="true" class=""><span class="check"><\/span><span class="caption"><\/span><\/label><span class="icon">';f=i.item1;switch(f){case".mp3":t+='<div class="audio"><\/div>';break;case".pdf":t+='<div class="pdf"><\/div>';break;case".docx":t+='<div class="docx"><\/div>';break;case".sql":t+='<div class="sql"><\/div>';break;case".mp4":case".mpg":t+='<div class="mp4"><\/div>';break;case".txt":t+='<div class="txt"><\/div>';break;case".exe":t+='<div class="exe"><\/div>';break;case".cs":t+='<div class="c-sharp"><\/div>';break;case".zip":t+='<div class="zip"><\/div>';break;case".jpg":case".jpeg":case".png":t+='<div class="image"><\/div>';break;default:t+='<div class="default"><\/div>'}t+='<\/span > <div class="data"><div class="caption">'+u+"<\/div><\/div><\/li > "})});t+="<\/ul>";t+="<\/li>";$("#listview").append(t)}var forward_path=[],Backward_path=[],oldPath,newPath,isDelete;$(document).ready(function(){getDrives(function(n){BindInitialTreeView(n);InitialContentData(n)});$("#backBtn").click(function(){if(Backward_path.length>0){forward_path.push($("#navPathfld").val());$("#navPathfld").val(Backward_path.pop());var n=$("#navPathfld").val();getDirectories(n,function(n){BindContentData(n)});getFiles(n,function(n){BindContentDataFiles(n)})}else getDrives(function(n){InitialContentData(n)})});$("#nextBtn").click(function(){if(forward_path.length>0){Backward_path.push($("#navPathfld").val());console.log(Backward_path);$("#navPathfld").val(forward_path.pop());var n=$("#navPathfld").val();getDirectories(n,function(n){BindContentData(n)});getFiles(n,function(n){BindContentDataFiles(n)})}});$("#refreshBtn").click(function(){refresh()});$("#searchBar").keyup(function(){var n=$("#navPathfld").val(),t=$("#searchBar").val();t.length>0?(SearchDirectoriesByName(n,t,function(n){BindContentData(n)}),SearchFilesByName(n,t,function(n){console.log(n);BindContentDataFiles(n)})):(getDirectories(n,function(n){BindContentData(n)}),getFiles(n,function(n){BindContentDataFiles(n)}))});$("#ddlLanguage").change(function(){var n={culture:$("#ddlLanguage").val(),returnUrl:"Index"};$.post("Home/ChangeLanguage",n,function(){getDrives(function(n){window.location.reload();InitialContentData(n)})})});$(".file-btn").click(function(){$(".file-options").toggle()});$("#Close").click(function(){window.top.close()});$("#newTab").click(function(){window.open("https://localhost:44390/","_blank")});$("#help").click(function(){window.open("https://support.microsoft.com/en-us/windows/help-in-file-explorer-a2d33543-5242-788d-8994-b0be10ae5bca","_blank")});$("body").on("keydown mousedown","#Contentfiles",function(n){if(n.ctrlKey&&n.which===1){var t=$("#PopupModal");$("#PopupModal").modal("show");element=this;console.log(element);t.css({top:n.pageY+"px",left:n.pageX+"px",innerWidth:"300px",outerWidth:"300px",width:"300px"});$("#copy").click(function(){oldPath=$(element).data("path");isDelete=!1;refresh()});$("#cut").click(function(){oldPath=$(element).data("path");isDelete=!0;$(element).find(".icon img").fadeTo("fast",.15)});$("#delete").click(function(){oldPath=$(element).data("path");isDelete=!0;$.ajax({url:"/Home/DeleteData",method:"GET",contentType:JSON,data:{oldPath:oldPath},success:function(n){n.ok&&refresh()}})});$("#paste").click(function(){newPath=$(element).data("path");console.log(oldPath);console.log(newPath);var n={newPath:newPath,oldPath:oldPath,isDelete:isDelete};$.ajax({url:"/Home/SaveData",method:"GET",contentType:JSON,data:n,success:function(n){n.ok&&refresh()}})});$(document).on("click",function(){$("#PopupModal").modal("hide")})}});$("body").on("click","#mainfiles",function(){var n=$(this).data("path");Backward_path.push(n);$("#navPathfld").prop("value",n);getDirectories(n,function(n){BindContentData(n)});getFiles(n,function(n){BindContentDataFiles(n)})});$("body").on("dblclick","#Contentfiles",function(){var n=$(this).data("path");Backward_path.push(n);$("#navPathfld").prop("value",n);getDirectories(n,function(n){BindContentData(n)});getFiles(n,function(n){console.log(n);BindContentDataFiles(n)})});$("body").on("dblclick","#files",function(){var t=this,n=$(this).data("path");console.log(n);Backward_path.push(n);$("#navPathfld").prop("value",n);($(this).hasClass("tree-node expanded")||$(this).hasClass("tree-node current expanded"))&&(getDirectories(n,function(n){BindInternalTreeView(n,t);BindContentData(n)}),getFiles(n,function(n){console.log(n);BindContentDataFiles(n)}))})});